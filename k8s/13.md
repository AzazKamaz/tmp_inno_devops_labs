## Lab13

### 3

-
    ```bash
    helm install -n lab13 app-python ./charts/app-python \
        --set replicaCount=3
    ```
-
    ```bash
    kubectl -n lab13 get po,sts,svc,pvc
    ```
    ```
    NAME               READY   STATUS    RESTARTS   AGE
    pod/app-python-0   1/1     Running   0          3m49s
    pod/app-python-1   1/1     Running   0          3m47s
    pod/app-python-2   1/1     Running   0          3m43s

    NAME                          READY   AGE
    statefulset.apps/app-python   3/3     3m49s

    NAME                 TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE
    service/app-python   ClusterIP   10.97.173.120   <none>        80/TCP    3m49s

    NAME                                            STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
    persistentvolumeclaim/volume-app-python-0       Bound    pvc-5217cbfd-a659-4557-8629-bf1b105810a5   1Mi        RWO            hostpath       3m49s
    persistentvolumeclaim/volume-app-python-1       Bound    pvc-a3503a94-571a-4952-993e-31645b53c666   1Mi        RWO            hostpath       3m47s
    persistentvolumeclaim/volume-app-python-2       Bound    pvc-69601139-96a4-4b55-b2a6-c5d9f40d0afc   1Mi        RWO            hostpath       3m43s
    persistentvolumeclaim/volume-app-python-oom-0   Bound    pvc-63c03326-6320-4c79-a9c5-f6ae67d72e2e   1Mi        RWO            hostpath       5m15s
    persistentvolumeclaim/volume-app-python-oom-1   Bound    pvc-373288dd-0cad-4cf2-bef4-7533ebdf8f57   1Mi        RWO            hostpath       5m13s
    persistentvolumeclaim/volume-app-python-oom-2   Bound    pvc-2f76312b-44ed-49a0-a909-f94adaeb9ccb   1Mi        RWO            hostpath       5m10s
    ```
-
    ```bash
    kubectl -n lab13 port-forward statefulset.apps/app-python 8080:8080
    ```
- repeat `curl http://localhost:8080/` for several times
-
    ```bash
    kubectl -n lab13 exec pod/app-python-0 -- cat /app/volume/visits.txt
    ```
    ```
    14
    ```
-
    ```bash
    kubectl -n lab13 exec pod/app-python-1 -- cat /app/volume/visits.txt
    ```
    ```
    cat: /app/volume/visits.txt: No such file or directory
    ```
-
    ```bash
    kubectl -n lab13 exec pod/app-python-2 -- cat /app/volume/visits.txt
    ```
    ```
    cat: /app/volume/visits.txt: No such file or directory
    ```

As we can see `kubectl port-forward` is always picking first pod which means that it doesn't have active target balancing. It will select other one if first will be overloaded/crashed. To get such behaviour LoadBalancer should be used because it is it what explicitly offer such a feature

### 4

Startup order is not important since all instances are independent. They do not have dependencies on each other and they do not touch same unsafe resources (they have their own persistance volumes for each of them)